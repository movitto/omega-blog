<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Motel::Registry
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Motel.html" title="Motel (module)">Motel</a></span></span>
     &raquo; 
    <span class="title">Registry</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Motel::Registry
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Motel::Registry</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../Omega/Server/Registry.html" title="Omega::Server::Registry (module)">Omega::Server::Registry</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/motel/registry.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Motel::Registry is a singleton class/object which acts as the primary
mechanism to run locations in the system.</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../Omega/Server/Registry.html" title="Omega::Server::Registry (module)">Omega::Server::Registry</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Omega/Server/Registry.html#DEFAULT_COMMAND_POLL-constant" title="Omega::Server::Registry::DEFAULT_COMMAND_POLL (constant)">Omega::Server::Registry::DEFAULT_COMMAND_POLL</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#DEFAULT_EVENT_POLL-constant" title="Omega::Server::Registry::DEFAULT_EVENT_POLL (constant)">Omega::Server::Registry::DEFAULT_EVENT_POLL</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#DEFAULT_LOOP_POLL-constant" title="Omega::Server::Registry::DEFAULT_LOOP_POLL (constant)">Omega::Server::Registry::DEFAULT_LOOP_POLL</a></span></p>




  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Omega/Server/Registry.html" title="Omega::Server::Registry (module)">Omega::Server::Registry</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Omega/Server/Registry.html#backup_excludes-instance_method" title="Omega::Server::Registry#backup_excludes (method)">#backup_excludes</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#node-instance_method" title="Omega::Server::Registry#node (method)">#node</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#retrieval-instance_method" title="Omega::Server::Registry#retrieval (method)">#retrieval</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#user-instance_method" title="Omega::Server::Registry#user (method)">#user</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#validation_methods-instance_method" title="Omega::Server::Registry#validation_methods (method)">#validation_methods</a></span></p>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Registry) <strong>initialize</strong> </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Registry.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Omega/Server/Registry.html" title="Omega::Server::Registry (module)">Omega::Server::Registry</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Omega/Server/Registry.html#%3C%3C-instance_method" title="Omega::Server::Registry#&lt;&lt; (method)">#<<</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#cleanup_event-instance_method" title="Omega::Server::Registry#cleanup_event (method)">#cleanup_event</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#clear%21-instance_method" title="Omega::Server::Registry#clear! (method)">#clear!</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#delete-instance_method" title="Omega::Server::Registry#delete (method)">#delete</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#entities-instance_method" title="Omega::Server::Registry#entities (method)">#entities</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#entity-instance_method" title="Omega::Server::Registry#entity (method)">#entity</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#exclude_from_backup-instance_method" title="Omega::Server::Registry#exclude_from_backup (method)">#exclude_from_backup</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#join-instance_method" title="Omega::Server::Registry#join (method)">#join</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#on-instance_method" title="Omega::Server::Registry#on (method)">#on</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#proxies_for-instance_method" title="Omega::Server::Registry#proxies_for (method)">#proxies_for</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#proxy_for-instance_method" title="Omega::Server::Registry#proxy_for (method)">#proxy_for</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#raise_event-instance_method" title="Omega::Server::Registry#raise_event (method)">#raise_event</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#restore-instance_method" title="Omega::Server::Registry#restore (method)">#restore</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#run-instance_method" title="Omega::Server::Registry#run (method)">#run</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#running%3F-instance_method" title="Omega::Server::Registry#running? (method)">#running?</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#safe_exec-instance_method" title="Omega::Server::Registry#safe_exec (method)">#safe_exec</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#save-instance_method" title="Omega::Server::Registry#save (method)">#save</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#start-instance_method" title="Omega::Server::Registry#start (method)">#start</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#stop-instance_method" title="Omega::Server::Registry#stop (method)">#stop</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#to_s-instance_method" title="Omega::Server::Registry#to_s (method)">#to_s</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#update-instance_method" title="Omega::Server::Registry#update (method)">#update</a></span>, <span class='object_link'><a href="../Omega/Server/Registry.html#validation_callback-instance_method" title="Omega::Server::Registry#validation_callback (method)">#validation_callback</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Motel::Registry (class)">Registry</a></span></tt>) <strong>initialize</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A new instance of Registry</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/motel/registry.rb', line 151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='id identifier rubyid_init_registry'>init_registry</span>

  <span class='id identifier rubyid_exclude_from_backup'>exclude_from_backup</span> <span class='const'>Omega</span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'>Callback</span>

  <span class='comment'># validate location ids are unique before creating
</span>  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_validation_callback'>validation_callback</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_r'>r</span><span class='comma'>,</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
    <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Location</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>

    <span class='op'>!</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='op'>|</span> <span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='rbrace'>}</span>

  <span class='comment'># perform a few sanity checks on location / update any attributes needing it
</span>  <span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='symbol'>:added</span><span class='rparen'>)</span>   <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_loc'>loc</span><span class='op'>|</span> <span class='id identifier rubyid_check_location'>check_location</span><span class='lparen'>(</span><span class='id identifier rubyid_loc'>loc</span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='symbol'>:updated</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_loc'>loc</span><span class='comma'>,</span><span class='id identifier rubyid_oloc'>oloc</span><span class='op'>|</span> <span class='id identifier rubyid_check_location'>check_location</span><span class='lparen'>(</span><span class='id identifier rubyid_loc'>loc</span><span class='comma'>,</span><span class='id identifier rubyid_oloc'>oloc</span><span class='rparen'>)</span><span class='rbrace'>}</span>

  <span class='comment'># setup parent when entity is added or updated
</span>  <span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='symbol'>:added</span><span class='rparen'>)</span>   <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_loc'>loc</span><span class='op'>|</span> <span class='id identifier rubyid_adjust_heirarchry'>adjust_heirarchry</span><span class='lparen'>(</span><span class='id identifier rubyid_loc'>loc</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='symbol'>:updated</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_loc'>loc</span><span class='comma'>,</span><span class='id identifier rubyid_oloc'>oloc</span><span class='op'>|</span> <span class='id identifier rubyid_adjust_heirarchry'>adjust_heirarchry</span><span class='lparen'>(</span><span class='id identifier rubyid_loc'>loc</span><span class='comma'>,</span><span class='id identifier rubyid_oloc'>oloc</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

  <span class='comment'># setup location callbacks
</span>  <span class='const'>LOCATION_EVENTS</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
    <span class='id identifier rubyid_on'>on</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_loc'>loc</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
      <span class='ivar'>@lock</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span><span class='lbrace'>{</span>
        <span class='comment'># run event on registry location
</span>        <span class='id identifier rubyid_rloc'>rloc</span> <span class='op'>=</span> <span class='ivar'>@entities</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='id identifier rubyid_loc'>loc</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_rloc'>rloc</span><span class='period'>.</span><span class='id identifier rubyid_raise_event'>raise_event</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>

  <span class='comment'># start location runner
</span>  <span class='id identifier rubyid_run'>run</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_run_locations'>run_locations</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


</div>

    <div id="footer">
  Generated on Fri Feb 21 16:44:35 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>