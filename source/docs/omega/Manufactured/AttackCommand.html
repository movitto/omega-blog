<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Manufactured::AttackCommand
  
    &mdash; Documentation by YARD 0.7.4
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (A)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Manufactured.html" title="Manufactured (module)">Manufactured</a></span></span>
     &raquo; 
    <span class="title">AttackCommand</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Manufactured::AttackCommand
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Manufactured::AttackCommand</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/manufactured/commands.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents action of one <span class='object_link'><a href="Ship.html" title="Manufactured::Ship (class)">Ship</a></span> attacking another</p>

<p>Registered with the registry by a client when attacker commences attacking
and periodically run by registry until attacked stops, defender is
destroyed, or one of several other conditions occur.</p>

<p>Invokes various Manufactured::Callback handlers upon various events.</p>


  </div>
</div>
<div class="tags">
  

</div>

  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#attacker-instance_method" title="#attacker (instance method)">- (Object) <strong>attacker</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p><span class='object_link'><a href="Ship.html" title="Manufactured::Ship (class)">Ship</a></span> performing the attack.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#defender-instance_method" title="#defender (instance method)">- (Object) <strong>defender</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p><span class='object_link'><a href="Ship.html" title="Manufactured::Ship (class)">Ship</a></span> receiving that attack.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#hooks-instance_method" title="#hooks (instance method)">- (Object) <strong>hooks</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hash of command sequence events to callbale handlers to invoke on those
events.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_attack_time-instance_method" title="#last_attack_time (instance method)">- (Object) <strong>last_attack_time</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Time of last time <span class='object_link'><a href="#attack%21-instance_method" title="Manufactured::AttackCommand#attack! (method)">#attack!</a></span> was invoked.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attack%21-instance_method" title="#attack! (instance method)">- (Object) <strong>attack!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Ensure attack command is still valid and perform one attack cycle.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attackable%3F-instance_method" title="#attackable? (instance method)">- (true, false) <strong>attackable?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns boolean indicating if attack! can / should be called.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#id-instance_method" title="#id (instance method)">- (Object) <strong>id</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return the unique id of this attack command.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (AttackCommand) <strong>initialize</strong>(args = {}) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Manufactured::AttackCommand initializer.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove%3F-instance_method" title="#remove? (instance method)">- (true, false) <strong>remove?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns boolean indicating if this attack command should be removed.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Manufactured::AttackCommand (class)">AttackCommand</a></span></tt>) <strong>initialize</strong>(args = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Manufactured::AttackCommand initializer</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>hash of options to initialize attack command with</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <h3>Options Hash (<tt>args</tt>):</h3>
    <ul class="option">
      
        <li>
          <span class="name">:attacker</span>
          <span class="type">(<tt><span class='object_link'><a href="Ship.html" title="Manufactured::Ship (class)">Manufactured::Ship</a></span></tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'>
<p>ship attacking the defender</p>
</div>
        </li>
      
        <li>
          <span class="name">:defender</span>
          <span class="type">(<tt><span class='object_link'><a href="Ship.html" title="Manufactured::Ship (class)">Manufactured::Ship</a></span></tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'>
<p>ship receiving attack from the attacker</p>
</div>
        </li>
      
        <li>
          <span class="name">:before</span>
          <span class="type">(<tt>Callable</tt>)</span>
          <span class="default">
            
          </span>
          &mdash; <div class='inline'>
<p>callable object to register with the 'before' hooks</p>
</div>
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 38</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@attacker</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:attacker</span><span class='rbracket'>]</span>
  <span class='ivar'>@defender</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:defender</span><span class='rbracket'>]</span>
  <span class='ivar'>@remove</span>   <span class='op'>=</span> <span class='kw'>false</span>

  <span class='ivar'>@hooks</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:before</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='ivar'>@hooks</span><span class='lbracket'>[</span><span class='symbol'>:before</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:before</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:before</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="attacker=-instance_method"></span>
      <span id="attacker-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="attacker-instance_method">
  
    - (<tt>Object</tt>) <strong>attacker</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p><span class='object_link'><a href="Ship.html" title="Manufactured::Ship (class)">Ship</a></span> performing the attack</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 21</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attacker'>attacker</span>
  <span class='ivar'>@attacker</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="defender=-instance_method"></span>
      <span id="defender-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="defender-instance_method">
  
    - (<tt>Object</tt>) <strong>defender</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p><span class='object_link'><a href="Ship.html" title="Manufactured::Ship (class)">Ship</a></span> receiving that attack</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_defender'>defender</span>
  <span class='ivar'>@defender</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="hooks=-instance_method"></span>
      <span id="hooks-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="hooks-instance_method">
  
    - (<tt>Object</tt>) <strong>hooks</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Hash of command sequence events to callbale handlers to invoke on those
events. Valid values for keys include: :before</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 31</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hooks'>hooks</span>
  <span class='ivar'>@hooks</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="last_attack_time=-instance_method"></span>
      <span id="last_attack_time-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="last_attack_time-instance_method">
  
    - (<tt>Object</tt>) <strong>last_attack_time</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Time of last time <span class='object_link'><a href="#attack%21-instance_method" title="Manufactured::AttackCommand#attack! (method)">#attack!</a></span> was invoked</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 27</span>

<span class='kw'>def</span> <span class='id identifier rubyid_last_attack_time'>last_attack_time</span>
  <span class='ivar'>@last_attack_time</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="attack!-instance_method">
  
    - (<tt>Object</tt>) <strong>attack!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Ensure attack command is still valid and perform one attack cycle.</p>

<p>This method ensures the attack would still be valid (ships are close
enough, etc) and then launches the attack.</p>

<p>Also invokes <span class='object_link'><a href="Callback.html" title="Manufactured::Callback (class)">Callback</a></span>s registered with the attacker  and
defender before/during/after the attack cycle with the event type, the
attacking ship, and the defending ship as params</p>

<p>The callback events/types invoked include:</p>
<ul><li>
<p>'attacked_stop' - invoked on the attacker when attacker stops attacking</p>
</li><li>
<p>'attacked_stop' - invoked on the defender when attacker stops attacking</p>
</li><li>
<p>'attacked'      - invoked on the attacker when attacker actually launches
the attack</p>
</li><li>
<p>'defended'      - invoked on the defender when attacker actually launches
the attack</p>
</li><li>
<p>'destroyed'     - invoked on the defender if this attack cycle resulted in
the defender hp becoming &lt;= 0</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 82</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attack!'>attack!</span>
  <span class='const'>RJR</span><span class='op'>::</span><span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invoking attack command </span><span class='embexpr_beg'>#{</span><span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='tstring_content'> -&gt; </span><span class='embexpr_beg'>#{</span><span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># FIXME ensure attacker has not been destroyed itself
</span>  <span class='comment'># ensure entities are within attacking distance
</span>  <span class='kw'>unless</span> <span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_can_attack?'>can_attack?</span><span class='lparen'>(</span><span class='ivar'>@defender</span><span class='rparen'>)</span>
    <span class='comment'># invoke attackers's 'attacked_stop' callbacks
</span>    <span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_notification_callbacks'>notification_callbacks</span><span class='period'>.</span>
              <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:attacked_stop</span><span class='rbrace'>}</span><span class='period'>.</span>
              <span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>attacked_stop</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='ivar'>@attacker</span><span class='comma'>,</span> <span class='ivar'>@defender</span>
    <span class='rbrace'>}</span>

    <span class='comment'># invoke defender's 'defended_stop' callbacks
</span>    <span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_notification_callbacks'>notification_callbacks</span><span class='period'>.</span>
              <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:defended_stop</span><span class='rbrace'>}</span><span class='period'>.</span>
              <span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>defended_stop</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='ivar'>@attacker</span><span class='comma'>,</span> <span class='ivar'>@defender</span>
    <span class='rbrace'>}</span>

    <span class='ivar'>@remove</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='ivar'>@last_attack_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>

  <span class='comment'># TODO incorporate a hit / miss probability into this
</span>  <span class='comment'># TODO incorporate shields / AC / other defense mechanisms into this
</span>  <span class='comment'># TODO delay between launching attack and it arriving at defender
</span>  <span class='comment'>#   (depending on distance and projectile speed)
</span>
  <span class='comment'># reduce defender's hp
</span>  <span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_hp'>hp</span> <span class='op'>-=</span> <span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_damage_dealt'>damage_dealt</span>

  <span class='comment'># invoke attacker's 'attacked' callbacks
</span>  <span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_notification_callbacks'>notification_callbacks</span><span class='period'>.</span>
            <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:attacked</span><span class='rbrace'>}</span><span class='period'>.</span>
            <span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>attacked</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='ivar'>@attacker</span><span class='comma'>,</span> <span class='ivar'>@defender</span>
  <span class='rbrace'>}</span>

  <span class='comment'># invoke defender's 'defended' callbacks
</span>  <span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_notification_callbacks'>notification_callbacks</span><span class='period'>.</span>
            <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:defended</span><span class='rbrace'>}</span><span class='period'>.</span>
            <span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>defended</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='ivar'>@attacker</span><span class='comma'>,</span> <span class='ivar'>@defender</span>
  <span class='rbrace'>}</span>

  <span class='comment'># check if defender has been destroyed
</span>  <span class='kw'>if</span> <span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_hp'>hp</span> <span class='op'>&lt;=</span> <span class='int'>0</span>
    <span class='const'>RJR</span><span class='op'>::</span><span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='tstring_content'> destroyed </span><span class='embexpr_beg'>#{</span><span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbrace'>}</span><span class='tstring_content'>, marking for removal</span><span class='tstring_end'>&quot;</span></span>

    <span class='comment'># invoke defender's 'destroyed' callbacks
</span>    <span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_notification_callbacks'>notification_callbacks</span><span class='period'>.</span>
              <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:destroyed</span><span class='rbrace'>}</span><span class='period'>.</span>
              <span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>destroyed</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='ivar'>@attacker</span><span class='comma'>,</span> <span class='ivar'>@defender</span>
    <span class='rbrace'>}</span>

    <span class='comment'># remove this attack command
</span>    <span class='ivar'>@remove</span> <span class='op'>=</span> <span class='kw'>true</span>

    <span class='comment'># invoke attackers's 'attacked_stop' callbacks
</span>    <span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_notification_callbacks'>notification_callbacks</span><span class='period'>.</span>
              <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:attacked_stop</span><span class='rbrace'>}</span><span class='period'>.</span>
              <span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>attacked_stop</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='ivar'>@attacker</span><span class='comma'>,</span> <span class='ivar'>@defender</span>
    <span class='rbrace'>}</span>

    <span class='comment'># invoke defender's 'defended_stop' callbacks
</span>    <span class='ivar'>@defender</span><span class='period'>.</span><span class='id identifier rubyid_notification_callbacks'>notification_callbacks</span><span class='period'>.</span>
              <span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:defended_stop</span><span class='rbrace'>}</span><span class='period'>.</span>
              <span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
      <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>defended_stop</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='ivar'>@attacker</span><span class='comma'>,</span> <span class='ivar'>@defender</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="attackable?-instance_method">
  
    - (<tt>true</tt>, <tt>false</tt>) <strong>attackable?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns boolean indicating if attack! can / should be called.</p>

<p>Determines if enough time has lapsed since the last attack to compensate
for the attacker's attack rate</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>indicating if attack! can / cannot be called</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 62</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attackable?'>attackable?</span>
  <span class='comment'># elapsed time between mining cycles is less than ship's attack rate
</span>  <span class='kw'>return</span> <span class='ivar'>@last_attack_time</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='ivar'>@last_attack_time</span><span class='rparen'>)</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='op'>/</span> <span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_attack_rate'>attack_rate</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="id-instance_method">
  
    - (<tt>Object</tt>) <strong>id</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Return the unique id of this attack command.</p>

<p>Checked by the registry to ensure no two commands correspond to the same
operation. Currently returns attacker id indicating a ship may only attack
one other at a time, at some point we may want to incorporate multiple
weapons and area based weapons  (multiple defenders) into this</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@attacker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove?-instance_method">
  
    - (<tt>true</tt>, <tt>false</tt>) <strong>remove?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns boolean indicating if this attack command should be removed</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>true</tt>, <tt>false</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/commands.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove?'>remove?</span>
  <span class='ivar'>@remove</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sun Nov 25 08:35:33 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.4 (ruby-1.9.3).
</div>

  </body>
</html>