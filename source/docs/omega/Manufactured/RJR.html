<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Manufactured::RJR
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Manufactured.html" title="Manufactured (module)">Manufactured</a></span></span>
     &raquo; 
    <span class="title">RJR</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Manufactured::RJR
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
      <dt class="r1">Includes:</dt>
      <dd class="r1"><span class='object_link'><a href="../Manufactured.html" title="Manufactured (module)">Manufactured</a></span>, <span class='object_link'><a href="../Omega.html" title="Omega (module)">Omega</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html" title="Omega::Server::DSL (module)">Omega::Server::DSL</a></span></dd>
      
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/manufactured/rjr/inspect.rb<span class="defines">,<br />
  lib/manufactured/rjr/get.rb,<br /> lib/manufactured/rjr/dock.rb,<br /> lib/manufactured/rjr/loot.rb,<br /> lib/manufactured/rjr/init.rb,<br /> lib/manufactured/rjr/state.rb,<br /> lib/manufactured/rjr/attack.rb,<br /> lib/manufactured/rjr/create.rb,<br /> lib/manufactured/rjr/events.rb,<br /> lib/manufactured/rjr/mining.rb,<br /> lib/manufactured/rjr/movement.rb,<br /> lib/manufactured/rjr/resources.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>TODO</p>
<ul><li>
<p>total # of loot instances</p>
</li><li>
<p># of entities in diffent states (docked/undocked,attacking,mining,moving)</p>
</li><li>
<p># of transfers</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="GET_METHODS-constant" class="">GET_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:get_entities</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_get_entities'>get_entities</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="DOCK_METHODS-constant" class="">DOCK_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:dock</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_dock'>dock</span><span class='comma'>,</span>
<span class='symbol'>:undock</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_undock'>undock</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="LOOT_METHODS-constant" class="">LOOT_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:collect_loot</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_collect_loot'>collect_loot</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="PRIVILEGES-constant" class="">PRIVILEGES =
          <div class="docstring">
  <div class="discussion">
    
<p>Manufactured::RJR data</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cosmos_entities</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>modify</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cosmos_entities</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>users</span><span class='tstring_end'>&#39;</span></span>          <span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_attributes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>modify</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_attributes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>create</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>locations</span><span class='tstring_end'>&#39;</span></span>      <span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>locations</span><span class='tstring_end'>&#39;</span></span>      <span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>modify</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>locations</span><span class='tstring_end'>&#39;</span></span>      <span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>delete</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>locations</span><span class='tstring_end'>&#39;</span></span>      <span class='rbracket'>]</span><span class='comma'>,</span>
<span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>create</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>manufactured_entities</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span></pre></dd>
      
        <dt id="CALLBACK_METHODS-constant" class="">CALLBACK_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:motel_event</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_motel_event'>motel_event</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="STATE_METHODS-constant" class="">STATE_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:save_state</span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_save_state'>save_state</span><span class='comma'>,</span>
<span class='symbol'>:restore_state</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_restore_state'>restore_state</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="ATTACK_METHODS-constant" class="">ATTACK_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:attack_entity</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_attack_entity'>attack_entity</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="CREATE_METHODS-constant" class="">CREATE_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:validate_user_attributes</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_validate_user_attributes'>validate_user_attributes</span><span class='comma'>,</span>
<span class='symbol'>:create_entity</span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_create_entity'>create_entity</span><span class='comma'>,</span>
<span class='symbol'>:construct_entity</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_construct_entity'>construct_entity</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="EVENTS_METHODS-constant" class="">EVENTS_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:subscribe_to</span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_subscribe_to'>subscribe_to</span><span class='comma'>,</span>
<span class='symbol'>:remove_callbacks</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_remove_callbacks'>remove_callbacks</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="MINING_METHODS-constant" class="">MINING_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:start_mining</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_start_mining'>start_mining</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="INSPECT_METHODS-constant" class="">INSPECT_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:get_cmd</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_get_cmd'>get_cmd</span><span class='comma'>,</span>
<span class='symbol'>:get_status</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_get_status'>get_status</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="MOVEMENT_METHODS-constant" class="">MOVEMENT_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:move_entity</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_move_entity'>move_entity</span><span class='comma'>,</span>
<span class='symbol'>:follow_entity</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_follow_entity'>follow_entity</span><span class='comma'>,</span>
<span class='symbol'>:stop_entity</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_stop_entity'>stop_entity</span> <span class='rbrace'>}</span></pre></dd>
      
        <dt id="RESOURCES_METHODS-constant" class="">RESOURCES_METHODS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span> <span class='symbol'>:add_resource</span>      <span class='op'>=&gt;</span> <span class='id identifier rubyid_add_resource'>add_resource</span><span class='comma'>,</span>
<span class='symbol'>:transfer_resource</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_transfer_resource'>transfer_resource</span><span class='rbrace'>}</span></pre></dd>
      
    </dl>
  




  <h2>Config options <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#manufactured_rjr_password-class_method" title="manufactured_rjr_password (class method)">+ (Object) <strong>manufactured_rjr_password</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Password to use to communicate w/ other modules over the local rjr node.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#manufactured_rjr_username-class_method" title="manufactured_rjr_username (class method)">+ (Object) <strong>manufactured_rjr_username</strong> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>User to use to communicate w/ other modules over the local rjr node.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Config options
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_config-class_method" title="set_config (class method)">+ (Object) <strong>set_config</strong>(config) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set config options using Omega::Config instance.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#node-class_method" title="node (class method)">+ (Object) <strong>node</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#registry-class_method" title="registry (class method)">+ (Object) <strong>registry</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-class_method" title="reset (class method)">+ (Object) <strong>reset</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#user-class_method" title="user (class method)">+ (Object) <strong>user</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_registry-class_method" title="user_registry (class method)">+ (Object) <strong>user_registry</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cosmos_entity%3F-instance_method" title="#cosmos_entity? (instance method)">- (Boolean) <strong>cosmos_entity?</strong>(entity) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Bool indicating if specified entity is a cosmos subsystem entity.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_entity_between_systems-instance_method" title="#move_entity_between_systems (instance method)">- (Object) <strong>move_entity_between_systems</strong>(entity, sys) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Internal helper, move an entity between systems.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#move_entity_in_system-instance_method" title="#move_entity_in_system (instance method)">- (Object) <strong>move_entity_in_system</strong>(entity, loc) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Internal helper, move an entity in a single system.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#node-instance_method" title="#node (instance method)">- (Object) <strong>node</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#owner_permissions_for-instance_method" title="#owner_permissions_for (instance method)">- (Object) <strong>owner_permissions_for</strong>(entity) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Helper method to generate the permissions granted to the owner of a
manufactured entity upon creation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#registry-instance_method" title="#registry (instance method)">- (Object) <strong>registry</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subscribe_to_entity_event-instance_method" title="#subscribe_to_entity_event (instance method)">- (Object) <strong>subscribe_to_entity_event</strong>(entity_id, event_type, endpoint_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subscribe_to_subsystem_event-instance_method" title="#subscribe_to_subsystem_event (instance method)">- (Object) <strong>subscribe_to_subsystem_event</strong>(event_type, endpoint_id, *event_args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subsystem_entity%3F-instance_method" title="#subsystem_entity? (instance method)">- (Boolean) <strong>subsystem_entity?</strong>(entity) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Bool indicating if specified entity is a subsystem entity.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#subsystem_event%3F-instance_method" title="#subsystem_event? (instance method)">- (Boolean) <strong>subsystem_event?</strong>(event_type) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Bool indicating if specified event is in manufactured events namespace TODO
move to omega server dsl (?).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#user-instance_method" title="#user (instance method)">- (Object) <strong>user</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#user_registry-instance_method" title="#user_registry (instance method)">- (Object) <strong>user_registry</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_user_attributes-instance_method" title="#validate_user_attributes (instance method)">- (Object) <strong>validate_user_attributes</strong>(entities, entity) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>helper to validate use attributes upon entity creation.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Omega/Server/DSL.html" title="Omega::Server::DSL (module)">Omega::Server::DSL</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Omega/Server/DSL.html#check_attribute-instance_method" title="Omega::Server::DSL#check_attribute (method)">#check_attribute</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#check_privilege-instance_method" title="Omega::Server::DSL#check_privilege (method)">#check_privilege</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#current_session-instance_method" title="Omega::Server::DSL#current_session (method)">#current_session</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#current_user-instance_method" title="Omega::Server::DSL#current_user (method)">#current_user</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#delete_event_handler_for-instance_method" title="Omega::Server::DSL#delete_event_handler_for (method)">#delete_event_handler_for</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#filter_properties-instance_method" title="Omega::Server::DSL#filter_properties (method)">#filter_properties</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#filters_from_args-instance_method" title="Omega::Server::DSL#filters_from_args (method)">#filters_from_args</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#from_valid_source%3F-instance_method" title="Omega::Server::DSL#from_valid_source? (method)">#from_valid_source?</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#handle_node_closed-instance_method" title="Omega::Server::DSL#handle_node_closed (method)">#handle_node_closed</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#in_subsystem-instance_method" title="Omega::Server::DSL#in_subsystem (method)">#in_subsystem</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#is_cmd%3F-instance_method" title="Omega::Server::DSL#is_cmd? (method)">#is_cmd?</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#is_node%3F-instance_method" title="Omega::Server::DSL#is_node? (method)">#is_node?</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#login-instance_method" title="Omega::Server::DSL#login (method)">#login</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#matching-instance_method" title="Omega::Server::DSL#matching (method)">#matching</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#persistent_transport%3F-instance_method" title="Omega::Server::DSL#persistent_transport? (method)">#persistent_transport?</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#remove_callbacks_for-instance_method" title="Omega::Server::DSL#remove_callbacks_for (method)">#remove_callbacks_for</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#require_attribute-instance_method" title="Omega::Server::DSL#require_attribute (method)">#require_attribute</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#require_persistent_transport%21-instance_method" title="Omega::Server::DSL#require_persistent_transport! (method)">#require_persistent_transport!</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#require_privilege-instance_method" title="Omega::Server::DSL#require_privilege (method)">#require_privilege</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#require_state-instance_method" title="Omega::Server::DSL#require_state (method)">#require_state</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#require_valid_source%21-instance_method" title="Omega::Server::DSL#require_valid_source! (method)">#require_valid_source!</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#validate_session_source%21-instance_method" title="Omega::Server::DSL#validate_session_source! (method)">#validate_session_source!</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#with-instance_method" title="Omega::Server::DSL#with (method)">#with</a></span>, <span class='object_link'><a href="../Omega/Server/DSL.html#with_id-instance_method" title="Omega::Server::DSL#with_id (method)">#with_id</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  <div id="class_attr_details" class="attr_details">
    <h2>Class Attribute Details</h2>
    
      
      <span id="manufactured_rjr_password=-class_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="manufactured_rjr_password-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>manufactured_rjr_password</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Password to use to communicate w/ other modules over the local rjr node</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 28</span>

<span class='kw'>def</span> <span class='id identifier rubyid_manufactured_rjr_password'>manufactured_rjr_password</span>
  <span class='ivar'>@manufactured_rjr_password</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="manufactured_rjr_username=-class_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="manufactured_rjr_username-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>manufactured_rjr_username</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>User to use to communicate w/ other modules over the local rjr node</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_manufactured_rjr_username'>manufactured_rjr_username</span>
  <span class='ivar'>@manufactured_rjr_username</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="node-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>node</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 76</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_node'>node</span>
  <span class='ivar'>@node</span> <span class='op'>||=</span> <span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='const'>Nodes</span><span class='op'>::</span><span class='const'>Local</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='symbol'>:node_id</span> <span class='op'>=&gt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="registry-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>registry</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 92</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_registry'>registry</span>
  <span class='ivar'>@registry</span> <span class='op'>||=</span> <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>Registry</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reset</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 100</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
  <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='period'>.</span><span class='id identifier rubyid_registry'>registry</span><span class='period'>.</span><span class='id identifier rubyid_clear!'>clear!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_config-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>set_config</strong>(config) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set config options using Omega::Config instance</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>config</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Omega/Config.html" title="Omega::Config (class)">Omega::Config</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>object containing config options</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 33</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_config'>set_config</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_manufactured_rjr_username'>manufactured_rjr_username</span>  <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_manufactured_rjr_user'>manufactured_rjr_user</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_manufactured_rjr_password'>manufactured_rjr_password</span>  <span class='op'>=</span> <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_manufactured_rjr_pass'>manufactured_rjr_pass</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="user-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>user</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 66</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>
  <span class='ivar'>@user</span> <span class='op'>||=</span> <span class='const'>Users</span><span class='op'>::</span><span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:id</span>       <span class='op'>=&gt;</span> <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='id identifier rubyid_manufactured_rjr_username'>manufactured_rjr_username</span><span class='comma'>,</span>
                            <span class='symbol'>:password</span> <span class='op'>=&gt;</span> <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='id identifier rubyid_manufactured_rjr_password'>manufactured_rjr_password</span><span class='comma'>,</span>
                            <span class='symbol'>:registration_code</span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="user_registry-class_method">
  
    + (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>user_registry</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 84</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_user_registry'>user_registry</span>
  <span class='const'>Users</span><span class='op'>::</span><span class='const'>RJR</span><span class='period'>.</span><span class='id identifier rubyid_registry'>registry</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cosmos_entity?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>cosmos_entity?</strong>(entity) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Bool indicating if specified entity is a cosmos subsystem entity</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/events.rb', line 29</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cosmos_entity?'>cosmos_entity?</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='rparen'>)</span>
  <span class='const'>Cosmos</span><span class='op'>::</span><span class='const'>Entities</span><span class='period'>.</span><span class='id identifier rubyid_module_classes'>module_classes</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_cl'>cl</span><span class='op'>|</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='id identifier rubyid_cl'>cl</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_entity_between_systems-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>move_entity_between_systems</strong>(entity, sys) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Internal helper, move an entity between systems</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/movement.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_entity_between_systems'>move_entity_between_systems</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='id identifier rubyid_sys'>sys</span><span class='rparen'>)</span>

  <span class='comment'># if moving ship ensure
</span>  <span class='comment'># - a jump gate within trigger distance is nearby
</span>  <span class='comment'># - ship is not docked
</span>  <span class='comment'>#
</span>  <span class='comment'># (TODO optional transport delay / jump time)
</span>  <span class='comment'># (TODO optional skipping this check if user has sufficient
</span>  <span class='comment'>#       privs modify-manufactured_entities ?)
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>Ship</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_near_jg'>near_jg</span> <span class='op'>=</span>
      <span class='op'>!</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_solar_system'>solar_system</span><span class='period'>.</span><span class='id identifier rubyid_jump_gates'>jump_gates</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_jg'>jg</span><span class='op'>|</span>
        <span class='id identifier rubyid_jg'>jg</span><span class='period'>.</span><span class='id identifier rubyid_endpoint_id'>endpoint_id</span> <span class='op'>==</span> <span class='id identifier rubyid_sys'>sys</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>&amp;&amp;</span>
        <span class='lparen'>(</span><span class='id identifier rubyid_jg'>jg</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span> <span class='op'>-</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='rparen'>)</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_jg'>jg</span><span class='period'>.</span><span class='id identifier rubyid_trigger_distance'>trigger_distance</span>
       <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OperationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='embexpr_end'>}</span><span class='tstring_content'> not by jump gate</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_near_jg'>near_jg</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OperationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='embexpr_end'>}</span><span class='tstring_content'> docked</span><span class='tstring_end'>&quot;</span></span>           <span class='kw'>if</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_docked?'>docked?</span>
  <span class='kw'>end</span>

  <span class='comment'># set parent and location
</span>  <span class='comment'># TODO set loc x, y, z to vicinity of reverse jump gate
</span>  <span class='comment'>#       (gate to current system in destination system) if it exists ?
</span>  <span class='id identifier rubyid_orig_parent'>orig_parent</span> <span class='op'>=</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span>
  <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span> <span class='op'>=</span> <span class='id identifier rubyid_sys'>sys</span>
  <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_movement_strategy'>movement_strategy</span> <span class='op'>=</span>
    <span class='const'>Motel</span><span class='op'>::</span><span class='const'>MovementStrategies</span><span class='op'>::</span><span class='const'>Stopped</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span>

  <span class='comment'># update location and remove movement callbacks
</span>  <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motel::update_location</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>  <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motel::remove_callbacks</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>movement</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motel::remove_callbacks</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rotation</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_sys'>sys</span><span class='period'>.</span><span class='id identifier rubyid_proxy_to'>proxy_to</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_proxy'>proxy</span> <span class='op'>=</span> <span class='const'>Omega</span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'>ProxyNode</span><span class='period'>.</span><span class='id identifier rubyid_with_id'>with_id</span><span class='lparen'>(</span><span class='id identifier rubyid_sys'>sys</span><span class='period'>.</span><span class='id identifier rubyid_proxy_to'>proxy_to</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_login'>login</span>

    <span class='comment'># TODO invoke users::get with_id entity.user_id &amp;
</span>    <span class='comment'># if not present users::create_user ?
</span>    <span class='comment'># or perhaps err out (&#39;user not authorized to jump to remote system&#39;)?
</span>
    <span class='id identifier rubyid_proxy'>proxy</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>manufactured::create_entity</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span>

    <span class='comment'># XXX remove entity from local registry
</span>    <span class='id identifier rubyid_registry'>registry</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='op'>&amp;</span><span class='id identifier rubyid_with_id'>with_id</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motel::delete_location</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='comment'># also remove related privs
</span>    <span class='id identifier rubyid_user_role'>user_role</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user_role_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_owner_permissions_for'>owner_permissions_for</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='comma'>,</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
      <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>users::remove_privilege</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_user_role'>user_role</span><span class='comma'>,</span> <span class='id identifier rubyid_p'>p</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='rparen'>)</span>
    <span class='rbrace'>}</span>

  <span class='kw'>else</span>
    <span class='comment'># update registry entity
</span>    <span class='id identifier rubyid_registry'>registry</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span> <span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_with_id'>with_id</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># run new system_jump event in registry
</span>  <span class='id identifier rubyid_event'>event</span> <span class='op'>=</span> <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>Events</span><span class='op'>::</span><span class='const'>SystemJump</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='symbol'>:old_system</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_orig_parent'>orig_parent</span><span class='comma'>,</span>
                                               <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_entity'>entity</span>
  <span class='id identifier rubyid_registry'>registry</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_event'>event</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="move_entity_in_system-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>move_entity_in_system</strong>(entity, loc) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Internal helper, move an entity in a single system</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Omega/OperationError.html" title="Omega::OperationError (class)">OperationError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/movement.rb', line 14</span>

<span class='kw'>def</span> <span class='id identifier rubyid_move_entity_in_system'>move_entity_in_system</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='id identifier rubyid_loc'>loc</span><span class='rparen'>)</span>
  <span class='comment'># TODO may want to incorporate fuel into this at some point
</span>
  <span class='comment'># only ships can moving in a system for now, also ensure not docked
</span>  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OperationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='embexpr_end'>}</span><span class='tstring_content'> not ship</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Ship</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OperationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='embexpr_end'>}</span><span class='tstring_content'> docked</span><span class='tstring_end'>&quot;</span></span>   <span class='kw'>unless</span> <span class='op'>!</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_docked?'>docked?</span>

  <span class='comment'># calculate distance to move along each access
</span>  <span class='id identifier rubyid_dx'>dx</span> <span class='op'>=</span> <span class='id identifier rubyid_loc'>loc</span><span class='period'>.</span><span class='id identifier rubyid_x'>x</span> <span class='op'>-</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_x'>x</span>
  <span class='id identifier rubyid_dy'>dy</span> <span class='op'>=</span> <span class='id identifier rubyid_loc'>loc</span><span class='period'>.</span><span class='id identifier rubyid_y'>y</span> <span class='op'>-</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_y'>y</span>
  <span class='id identifier rubyid_dz'>dz</span> <span class='op'>=</span> <span class='id identifier rubyid_loc'>loc</span><span class='period'>.</span><span class='id identifier rubyid_z'>z</span> <span class='op'>-</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_z'>z</span>
  <span class='id identifier rubyid_distance'>distance</span> <span class='op'>=</span> <span class='id identifier rubyid_loc'>loc</span> <span class='op'>-</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>OperationError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='embexpr_end'>}</span><span class='tstring_content'> at location</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_distance'>distance</span> <span class='op'>&lt;</span> <span class='int'>1</span>

  <span class='comment'># Create linear movement strategy w/ movement trajectory
</span>  <span class='id identifier rubyid_linear'>linear</span> <span class='op'>=</span>
    <span class='const'>Motel</span><span class='op'>::</span><span class='const'>MovementStrategies</span><span class='op'>::</span><span class='const'>Linear</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='symbol'>:dx</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_dx'>dx</span><span class='op'>/</span><span class='id identifier rubyid_distance'>distance</span><span class='comma'>,</span>
                                          <span class='symbol'>:dy</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_dy'>dy</span><span class='op'>/</span><span class='id identifier rubyid_distance'>distance</span><span class='comma'>,</span>
                                          <span class='symbol'>:dz</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_dz'>dz</span><span class='op'>/</span><span class='id identifier rubyid_distance'>distance</span><span class='comma'>,</span>
                                          <span class='symbol'>:speed</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_movement_speed'>movement_speed</span>

  <span class='comment'># calculate the orientation difference
</span>  <span class='id identifier rubyid_od'>od</span> <span class='op'>=</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_orientation_difference'>orientation_difference</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_loc'>loc</span><span class='period'>.</span><span class='id identifier rubyid_coordinates'>coordinates</span><span class='rparen'>)</span>

  <span class='comment'># TODO introduce point_to_target flag in Linear movement strategy
</span>  <span class='comment'># (similar to Follow) &amp; use here, removing the need for the follow distinction
</span>
  <span class='comment'># if we are close enough to correct orientation,
</span>  <span class='comment'># register linear movement strategy with entity
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_od'>od</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span> <span class='op'>&lt;</span> <span class='lparen'>(</span><span class='const'>Math</span><span class='op'>::</span><span class='const'>PI</span> <span class='op'>/</span> <span class='int'>32</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_movement_strategy'>movement_strategy</span> <span class='op'>=</span> <span class='id identifier rubyid_linear'>linear</span>

  <span class='comment'># if we need to adjust orientation before moving,
</span>  <span class='comment'># register rotation movement strategy w/ entity
</span>  <span class='kw'>else</span>
    <span class='comment'># create the rotation movement strategy
</span>    <span class='id identifier rubyid_rotate'>rotate</span> <span class='op'>=</span>
      <span class='const'>Motel</span><span class='op'>::</span><span class='const'>MovementStrategies</span><span class='op'>::</span><span class='const'>Rotate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> \
        <span class='symbol'>:rot_theta</span> <span class='op'>=&gt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_od'>od</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>*</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_rotation_speed'>rotation_speed</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='symbol'>:rot_x</span>     <span class='op'>=&gt;</span>  <span class='id identifier rubyid_od'>od</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:rot_y</span>     <span class='op'>=&gt;</span>  <span class='id identifier rubyid_od'>od</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:rot_z</span>     <span class='op'>=&gt;</span>  <span class='id identifier rubyid_od'>od</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>

    <span class='comment'># register rotation w/ location, linear as next movement strategy
</span>    <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_movement_strategy'>movement_strategy</span> <span class='op'>=</span> <span class='id identifier rubyid_rotate'>rotate</span>
    <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_next_movement_strategy'>next_movement_strategy</span> <span class='op'>=</span> <span class='id identifier rubyid_linear'>linear</span>

    <span class='comment'># track location rotation
</span>    <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motel::track_rotation</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_od'>od</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># track location movement and update location
</span>  <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motel::track_movement</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_distance'>distance</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_node'>node</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motel::update_location</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='rparen'>)</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="node-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>node</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_node'>node</span>
  <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='period'>.</span><span class='id identifier rubyid_node'>node</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="owner_permissions_for-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>owner_permissions_for</strong>(entity) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Helper method to generate the permissions granted to the owner of a
manufactured entity upon creation</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_owner_permissions_for'>owner_permissions_for</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_entity_id'>entity_id</span>   <span class='op'>=</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='id identifier rubyid_location_id'>location_id</span> <span class='op'>=</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_location'>location</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>

  <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>view</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>manufactured_entity-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity_id'>entity_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
   <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>modify</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>manufactured_entity-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity_id'>entity_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
   <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>location-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_location_id'>location_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="registry-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>registry</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_registry'>registry</span>
  <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='period'>.</span><span class='id identifier rubyid_registry'>registry</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subscribe_to_entity_event-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>subscribe_to_entity_event</strong>(entity_id, event_type, endpoint_id) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/events.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subscribe_to_entity_event'>subscribe_to_entity_event</span><span class='lparen'>(</span><span class='id identifier rubyid_entity_id'>entity_id</span><span class='comma'>,</span> <span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span> <span class='id identifier rubyid_endpoint_id'>endpoint_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='const'>Omega</span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'>Callback</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='symbol'>:event_type</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span>
                                   <span class='symbol'>:endpoint_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_endpoint_id'>endpoint_id</span><span class='comma'>,</span>
                                   <span class='symbol'>:rjr_event</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>manufactured::event_occurred</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_cb'>cb</span><span class='period'>.</span><span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
    <span class='id identifier rubyid_err'>err</span> <span class='op'>=</span> <span class='kw'>false</span>

    <span class='kw'>begin</span>
      <span class='comment'># ensure user has access to view entity
</span>      <span class='id identifier rubyid_require_privilege'>require_privilege</span> <span class='symbol'>:registry</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_user_registry'>user_registry</span><span class='comma'>,</span> <span class='symbol'>:any</span> <span class='op'>=&gt;</span>
        <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>manufactured_entity-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
         <span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>manufactured_entities</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>

      <span class='comment'># invoke method via rjr callback notification
</span>      <span class='comment'>#
</span>      <span class='comment'># args does not include event/entity at this point, just simply has any
</span>      <span class='comment'># remaining event arguments
</span>      <span class='comment'>#
</span>      <span class='comment'># XXX args transformation between server callbacks being
</span>      <span class='comment'># invoked (in manufactured::commands) and here is somewhat
</span>      <span class='comment'># convoluted, would be nice to simplify
</span>      <span class='ivar'>@rjr_callback</span><span class='period'>.</span><span class='id identifier rubyid_notify'>notify</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>manufactured::event_occurred</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>

    <span class='kw'>rescue</span> <span class='const'>Omega</span><span class='op'>::</span><span class='const'>PermissionError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>entity </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> callback permission error </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_err'>err</span> <span class='op'>=</span> <span class='kw'>true</span>

    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>ConnectionError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>entity </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> client disconnected </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_err'>err</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='comment'># also entity.callbacks associated w/ @rjr_headers[&#39;session_id&#39;] ?
</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exception during </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'> callback </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_err'>err</span> <span class='op'>=</span> <span class='kw'>true</span>

    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_remove_callbacks_for'>remove_callbacks_for</span> <span class='id identifier rubyid_registry'>registry</span><span class='comma'>,</span> <span class='symbol'>:class</span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span>
                                     <span class='symbol'>:id</span>       <span class='op'>=&gt;</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
                                     <span class='symbol'>:type</span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span>
                                     <span class='symbol'>:endpoint</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_endpoint_id'>endpoint_id</span>   <span class='kw'>if</span> <span class='id identifier rubyid_err'>err</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_registry'>registry</span><span class='period'>.</span><span class='id identifier rubyid_safe_exec'>safe_exec</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_entities'>entities</span><span class='op'>|</span>
    <span class='id identifier rubyid_rentity'>rentity</span> <span class='op'>=</span> <span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='op'>&amp;</span><span class='id identifier rubyid_with_id'>with_id</span><span class='lparen'>(</span><span class='id identifier rubyid_entity_id'>entity_id</span><span class='rparen'>)</span>

    <span class='comment'># important need to atomically delete callbacks w/ same endpoint_id:
</span>    <span class='id identifier rubyid_remove_callbacks_for'>remove_callbacks_for</span> <span class='id identifier rubyid_entities'>entities</span><span class='comma'>,</span> <span class='symbol'>:class</span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_rentity'>rentity</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span>
                                   <span class='symbol'>:id</span>       <span class='op'>=&gt;</span> <span class='id identifier rubyid_rentity'>rentity</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
                                   <span class='symbol'>:type</span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_cb'>cb</span><span class='period'>.</span><span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span>
                                   <span class='symbol'>:endpoint</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_cb'>cb</span><span class='period'>.</span><span class='id identifier rubyid_endpoint_id'>endpoint_id</span>
    <span class='id identifier rubyid_rentity'>rentity</span><span class='period'>.</span><span class='id identifier rubyid_callbacks'>callbacks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cb'>cb</span>
  <span class='rbrace'>}</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subscribe_to_subsystem_event-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>subscribe_to_subsystem_event</strong>(event_type, endpoint_id, *event_args) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/events.rb', line 33</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subscribe_to_subsystem_event'>subscribe_to_subsystem_event</span><span class='lparen'>(</span><span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span> <span class='id identifier rubyid_endpoint_id'>endpoint_id</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_event_args'>event_args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>EventHandler</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='symbol'>:event_type</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span>
                                           <span class='symbol'>:endpoint_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_endpoint_id'>endpoint_id</span><span class='comma'>,</span>
                                           <span class='symbol'>:event_args</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_event_args'>event_args</span><span class='comma'>,</span>
                                           <span class='symbol'>:persist</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_handler'>handler</span><span class='period'>.</span><span class='id identifier rubyid_exec'>exec</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_manu_event'>manu_event</span><span class='op'>|</span>
    <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span><span class='id identifier rubyid_err_msg'>err_msg</span> <span class='op'>=</span> <span class='kw'>false</span><span class='comma'>,</span><span class='kw'>nil</span>
    <span class='kw'>begin</span>
      <span class='comment'># run through event args, running permission
</span>      <span class='comment'># checks on restricted entities
</span>      <span class='comment'># XXX hacky, would be nice to do this in a more structured manner
</span>      <span class='id identifier rubyid_manu_event'>manu_event</span><span class='period'>.</span><span class='id identifier rubyid_event_args'>event_args</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_arg'>arg</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_subsystem_entity?'>subsystem_entity?</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_require_privilege'>require_privilege</span> <span class='symbol'>:registry</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_user_registry'>user_registry</span><span class='comma'>,</span> <span class='symbol'>:any</span> <span class='op'>=&gt;</span>
            <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>manufactured_entity-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
             <span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>manufactured_entities</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_cosmos_entity?'>cosmos_entity?</span><span class='lparen'>(</span><span class='id identifier rubyid_arg'>arg</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_require_privilege'>require_privilege</span> <span class='symbol'>:registry</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_user_registry'>user_registry</span><span class='comma'>,</span> <span class='symbol'>:any</span> <span class='op'>=&gt;</span>
            <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cosmos_entity-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
             <span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cosmos_entities</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Motel</span><span class='op'>::</span><span class='const'>Location</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_require_privilege'>require_privilege</span> <span class='symbol'>:registry</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_user_registry'>user_registry</span><span class='comma'>,</span> <span class='symbol'>:any</span> <span class='op'>=&gt;</span>
            <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>location-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
             <span class='lbrace'>{</span><span class='symbol'>:privilege</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>view</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:entity</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>locations</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_restrict_view'>restrict_view</span>
        <span class='kw'>end</span>
      <span class='rbrace'>}</span>

      <span class='ivar'>@rjr_callback</span><span class='period'>.</span><span class='id identifier rubyid_notify'>notify</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>manufactured::event_occurred</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_manu_event'>manu_event</span><span class='period'>.</span><span class='id identifier rubyid_event_args'>event_args</span>

    <span class='kw'>rescue</span> <span class='const'>Omega</span><span class='op'>::</span><span class='const'>PermissionError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
          <span class='id identifier rubyid_err'>err</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_err_msg'>err_msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>manufactured event </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event_type'>event_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> \
                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>handler permission error </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>ConnectionError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
          <span class='id identifier rubyid_err'>err</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_err_msg'>err_msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>manufactured event </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event_type'>event_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> \
                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>client disconnected </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
          <span class='id identifier rubyid_err'>err</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_err_msg'>err_msg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exception during manufactured </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event_type'>event_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> \
                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>callback </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>ensure</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_err'>err</span>
        <span class='op'>::</span><span class='const'>RJR</span><span class='op'>::</span><span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='id identifier rubyid_err_msg'>err_msg</span>
        <span class='id identifier rubyid_delete_event_handler_for'>delete_event_handler_for</span><span class='lparen'>(</span><span class='symbol'>:event_type</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_event_type'>event_type</span><span class='comma'>,</span>
                                 <span class='symbol'>:endpoint_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_endpoint_id'>endpoint_id</span><span class='comma'>,</span>
                                 <span class='symbol'>:registry</span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_registry'>registry</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># registry event handler checks ensures endpoint/event_type uniqueness
</span>  <span class='id identifier rubyid_registry'>registry</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_handler'>handler</span>

  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subsystem_entity?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>subsystem_entity?</strong>(entity) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Bool indicating if specified entity is a subsystem entity.
<strong>note</strong> right now we&#39;re not considering Loot to be here
as those entities shouldn&#39;t be processed here</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/events.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subsystem_entity?'>subsystem_entity?</span><span class='lparen'>(</span><span class='id identifier rubyid_entity'>entity</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Ship</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Station</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="subsystem_event?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>subsystem_event?</strong>(event_type) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Bool indicating if specified event is in manufactured events namespace TODO
move to omega server dsl (?)</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/events.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_subsystem_event?'>subsystem_event?</span><span class='lparen'>(</span><span class='id identifier rubyid_event_type'>event_type</span><span class='rparen'>)</span>
  <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>Events</span><span class='period'>.</span><span class='id identifier rubyid_module_classes'>module_classes</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_evnt_class'>evnt_class</span><span class='op'>|</span>
    <span class='id identifier rubyid_evnt_class'>evnt_class</span><span class='op'>::</span><span class='const'>TYPE</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>==</span> <span class='id identifier rubyid_event_type'>event_type</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="user-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>user</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_user'>user</span>
  <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='period'>.</span><span class='id identifier rubyid_user'>user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="user_registry-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>user_registry</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/init.rb', line 88</span>

<span class='kw'>def</span> <span class='id identifier rubyid_user_registry'>user_registry</span>
  <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='period'>.</span><span class='id identifier rubyid_user_registry'>user_registry</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_user_attributes-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>validate_user_attributes</strong>(entities, entity) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>helper to validate use attributes upon entity creation</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/manufactured/rjr/create.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_user_attributes'>validate_user_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_entities'>entities</span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='rparen'>)</span>
  <span class='comment'># only applies to ships / stations
</span>  <span class='comment'># TODO skip this requirement if entity belongs to a npc user
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Ship</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Station</span><span class='rparen'>)</span>
    <span class='comment'># retrieve alive entities belonging to user
</span>    <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Ship</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Station</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
                              <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span> <span class='op'>==</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span>        <span class='op'>&amp;&amp;</span>
                            <span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Ship</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_alive?'>alive?</span><span class='rparen'>)</span>            <span class='rbrace'>}</span>

    <span class='id identifier rubyid_require_attribute'>require_attribute</span> <span class='symbol'>:node</span> <span class='op'>=&gt;</span> <span class='const'>Manufactured</span><span class='op'>::</span><span class='const'>RJR</span><span class='period'>.</span><span class='id identifier rubyid_node'>node</span><span class='comma'>,</span>
      <span class='symbol'>:user_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_entity'>entity</span><span class='period'>.</span><span class='id identifier rubyid_user_id'>user_id</span><span class='comma'>,</span>
      <span class='symbol'>:attribute_id</span> <span class='op'>=&gt;</span> <span class='const'>Users</span><span class='op'>::</span><span class='const'>Attributes</span><span class='op'>::</span><span class='const'>EntityManagementLevel</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
      <span class='symbol'>:level</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_n'>n</span><span class='op'>+</span><span class='int'>1</span>

    <span class='comment'># TODO also ensure user has attribute enabling them to
</span>    <span class='comment'># create entity of the specified type
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Feb 21 16:44:33 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>