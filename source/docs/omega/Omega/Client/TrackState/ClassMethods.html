<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Omega::Client::TrackState::ClassMethods
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Omega.html" title="Omega (module)">Omega</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Client.html" title="Omega::Client (module)">Client</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../TrackState.html" title="Omega::Client::TrackState (module)">TrackState</a></span></span>
     &raquo; 
    <span class="title">ClassMethods</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Omega::Client::TrackState::ClassMethods
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/omega/client/mixins.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Methods that are defined on the class including the TrackState module</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#server_state-instance_method" title="#server_state (instance method)">- (Object) <strong>server_state</strong>(state, args = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define a state for this entity type which clients can register on/off
handlers for specific entity instances.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="server_state-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>server_state</strong>(state, args = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define a state for this entity type which clients can register on/off
handlers for specific entity instances.</p>

<p>This method registers a callback to be invoked on entity initialization,
integrating the local entity w/ the TrackState module after which an entity
updated event handler is registered to detect changes in state</p>

<p>All callbacks registered here are invoked in the context of the entity w/
self as the only param</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>state</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>entity state which to define</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Hash&lt;Symbol,Callable&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>callbacks to use during the state lifecycle</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>args</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:check</span>
          <span class="type">(<tt>Callable</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>callback to invoke to check if the entity is in the specified state, should
return true/false</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:on</span>
          <span class="type">(<tt>Callable</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>callback to invoke when entity enters the specified state</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:off</span>
          <span class="type">(<tt>Callable</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>callback to invoke when entity leaves the specified state</p>
</div>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omega/client/mixins.rb', line 443</span>

<span class='kw'>def</span> <span class='id identifier rubyid_server_state'>server_state</span><span class='lparen'>(</span><span class='id identifier rubyid_state'>state</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_entity_init'>entity_init</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
    <span class='ivar'>@states</span>              <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@on_state_callbacks</span>  <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@off_state_callbacks</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:on</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_on_state'>on_state</span><span class='lparen'>(</span><span class='id identifier rubyid_state'>state</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:on</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:off</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_off_state'>off_state</span><span class='lparen'>(</span><span class='id identifier rubyid_state'>state</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:off</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='ivar'>@condition_checks</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:check</span><span class='rparen'>)</span>
      <span class='ivar'>@condition_checks</span><span class='lbracket'>[</span><span class='id identifier rubyid_state'>state</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:check</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_handle'>handle</span><span class='lparen'>(</span><span class='symbol'>:all</span><span class='rparen'>)</span><span class='lbrace'>{</span>
      <span class='comment'>#return if \@updating_state
</span>      <span class='comment'>#\@updating_state = true
</span>      <span class='ivar'>@condition_checks</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_st'>st</span><span class='comma'>,</span><span class='id identifier rubyid_check'>check</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_check'>check</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_set_state'>set_state</span> <span class='id identifier rubyid_st'>st</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_unset_state'>unset_state</span> <span class='id identifier rubyid_st'>st</span>
        <span class='kw'>end</span>
      <span class='rbrace'>}</span>
      <span class='comment'>#\@updating_state = false
</span>
    <span class='comment'># only need to register state check
</span>    <span class='comment'># event handler once as it will check all states
</span>    <span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='ivar'>@checking_state</span>
    <span class='ivar'>@checking_state</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Feb 21 16:44:33 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>