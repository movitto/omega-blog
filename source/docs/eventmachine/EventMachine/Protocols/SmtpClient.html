<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: EventMachine::Protocols::SmtpClient
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../EventMachine.html" title="EventMachine (module)">EventMachine</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Protocols.html" title="EventMachine::Protocols (module)">Protocols</a></span></span>
     &raquo; 
    <span class="title">SmtpClient</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: EventMachine::Protocols::SmtpClient
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../Connection.html" title="EventMachine::Connection (class)">Connection</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../Connection.html" title="EventMachine::Connection (class)">Connection</a></span></li>
          
            <li class="next">EventMachine::Protocols::SmtpClient</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../Deferrable.html" title="EventMachine::Deferrable (module)">Deferrable</a></span>, <span class='object_link'><a href="LineText2.html" title="EventMachine::Protocols::LineText2 (module)">LineText2</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/em/protocols/smtpclient.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Simple SMTP client</p>

<p>Sending generated emails (using mailfactory)</p>

<p>mail = MailFactory.new
  mail.to = ‘someone@site.co’
  mail.from = ‘me@site.com’
  mail.subject = ‘hi!’
  mail.text = ‘hello world’
  mail.html = ‘&lt;h1&gt;hello world&lt;/h1&gt;’</p>

<p>email = EM::P::SmtpClient.send(
    :domain=&gt;’site.com’,
    :from=&gt;mail.from,
    :to=&gt;mail.to,
    :content=&gt;”#mailmail.to_s\r\n.\r\n”
  )</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_email'>email</span> <span class='op'>=</span> <span class='const'>EM</span><span class='op'>::</span><span class='const'>Protocols</span><span class='op'>::</span><span class='const'>SmtpClient</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span>
  <span class='symbol'>:domain</span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>example.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='symbol'>:host</span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbol'>:port</span><span class='op'>=&gt;</span><span class='int'>25</span><span class='comma'>,</span> <span class='comment'># optional, defaults 25
</span>  <span class='symbol'>:starttls</span><span class='op'>=&gt;</span><span class='kw'>true</span><span class='comma'>,</span> <span class='comment'># use ssl
</span>  <span class='symbol'>:from</span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sender@example.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='symbol'>:to</span><span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>to_1@example.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>to_2@example.com</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='symbol'>:header</span><span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Subject</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is a subject line</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='symbol'>:body</span><span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This is the body of the email</span><span class='tstring_end'>&quot;</span></span>
<span class='rparen'>)</span>
<span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_callback'>callback</span><span class='lbrace'>{</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email sent!</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span>
<span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_errback'>errback</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Email failed!</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span></code></pre>
    
  </div>


</div>
  <h2>Constant Summary</h2>
  



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="LineText2.html" title="EventMachine::Protocols::LineText2 (module)">LineText2</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="LineText2.html#MaxBinaryLength-constant" title="EventMachine::Protocols::LineText2::MaxBinaryLength (constant)">LineText2::MaxBinaryLength</a></span>, <span class='object_link'><a href="LineText2.html#MaxLineLength-constant" title="EventMachine::Protocols::LineText2::MaxLineLength (constant)">LineText2::MaxLineLength</a></span></p>


  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#args%3D-instance_method" title="#args= (instance method)">- (Object) <strong>args</strong> </a>
    

    
  </span>
  
  
  
    
    
      <span class="note title writeonly">writeonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sets the attribute args.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send-class_method" title="send (class method)">+ (Object) <strong>send</strong>(args = {}) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>:host =&gt; required String.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (SmtpClient) <strong>initialize</strong> </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of SmtpClient.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="LineText2.html" title="EventMachine::Protocols::LineText2 (module)">LineText2</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="LineText2.html#receive_binary_data-instance_method" title="EventMachine::Protocols::LineText2#receive_binary_data (method)">#receive_binary_data</a></span>, <span class='object_link'><a href="LineText2.html#receive_data-instance_method" title="EventMachine::Protocols::LineText2#receive_data (method)">#receive_data</a></span>, <span class='object_link'><a href="LineText2.html#receive_end_of_binary_data-instance_method" title="EventMachine::Protocols::LineText2#receive_end_of_binary_data (method)">#receive_end_of_binary_data</a></span>, <span class='object_link'><a href="LineText2.html#set_binary_mode-instance_method" title="EventMachine::Protocols::LineText2#set_binary_mode (method)">#set_binary_mode</a></span>, <span class='object_link'><a href="LineText2.html#set_delimiter-instance_method" title="EventMachine::Protocols::LineText2#set_delimiter (method)">#set_delimiter</a></span>, <span class='object_link'><a href="LineText2.html#set_line_mode-instance_method" title="EventMachine::Protocols::LineText2#set_line_mode (method)">#set_line_mode</a></span>, <span class='object_link'><a href="LineText2.html#set_text_mode-instance_method" title="EventMachine::Protocols::LineText2#set_text_mode (method)">#set_text_mode</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Deferrable.html" title="EventMachine::Deferrable (module)">Deferrable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Deferrable.html#callback-instance_method" title="EventMachine::Deferrable#callback (method)">#callback</a></span>, <span class='object_link'><a href="../Deferrable.html#cancel_callback-instance_method" title="EventMachine::Deferrable#cancel_callback (method)">#cancel_callback</a></span>, <span class='object_link'><a href="../Deferrable.html#cancel_errback-instance_method" title="EventMachine::Deferrable#cancel_errback (method)">#cancel_errback</a></span>, <span class='object_link'><a href="../Deferrable.html#cancel_timeout-instance_method" title="EventMachine::Deferrable#cancel_timeout (method)">#cancel_timeout</a></span>, <span class='object_link'><a href="../Deferrable.html#errback-instance_method" title="EventMachine::Deferrable#errback (method)">#errback</a></span>, <span class='object_link'><a href="../Deferrable.html#fail-instance_method" title="EventMachine::Deferrable#fail (method)">#fail</a></span>, <span class='object_link'><a href="../Deferrable.html#future-class_method" title="EventMachine::Deferrable.future (method)">future</a></span>, <span class='object_link'><a href="../Deferrable.html#set_deferred_status-instance_method" title="EventMachine::Deferrable#set_deferred_status (method)">#set_deferred_status</a></span>, <span class='object_link'><a href="../Deferrable.html#succeed-instance_method" title="EventMachine::Deferrable#succeed (method)">#succeed</a></span>, <span class='object_link'><a href="../Deferrable.html#timeout-instance_method" title="EventMachine::Deferrable#timeout (method)">#timeout</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../Connection.html" title="EventMachine::Connection (class)">Connection</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Connection.html#close_connection-instance_method" title="EventMachine::Connection#close_connection (method)">#close_connection</a></span>, <span class='object_link'><a href="../Connection.html#close_connection_after_writing-instance_method" title="EventMachine::Connection#close_connection_after_writing (method)">#close_connection_after_writing</a></span>, <span class='object_link'><a href="../Connection.html#comm_inactivity_timeout-instance_method" title="EventMachine::Connection#comm_inactivity_timeout (method)">#comm_inactivity_timeout</a></span>, <span class='object_link'><a href="../Connection.html#comm_inactivity_timeout%3D-instance_method" title="EventMachine::Connection#comm_inactivity_timeout= (method)">#comm_inactivity_timeout=</a></span>, <span class='object_link'><a href="../Connection.html#detach-instance_method" title="EventMachine::Connection#detach (method)">#detach</a></span>, <span class='object_link'><a href="../Connection.html#error%3F-instance_method" title="EventMachine::Connection#error? (method)">#error?</a></span>, <span class='object_link'><a href="../Connection.html#get_idle_time-instance_method" title="EventMachine::Connection#get_idle_time (method)">#get_idle_time</a></span>, <span class='object_link'><a href="../Connection.html#get_peer_cert-instance_method" title="EventMachine::Connection#get_peer_cert (method)">#get_peer_cert</a></span>, <span class='object_link'><a href="../Connection.html#get_peername-instance_method" title="EventMachine::Connection#get_peername (method)">#get_peername</a></span>, <span class='object_link'><a href="../Connection.html#get_pid-instance_method" title="EventMachine::Connection#get_pid (method)">#get_pid</a></span>, <span class='object_link'><a href="../Connection.html#get_proxied_bytes-instance_method" title="EventMachine::Connection#get_proxied_bytes (method)">#get_proxied_bytes</a></span>, <span class='object_link'><a href="../Connection.html#get_sock_opt-instance_method" title="EventMachine::Connection#get_sock_opt (method)">#get_sock_opt</a></span>, <span class='object_link'><a href="../Connection.html#get_sockname-instance_method" title="EventMachine::Connection#get_sockname (method)">#get_sockname</a></span>, <span class='object_link'><a href="../Connection.html#get_status-instance_method" title="EventMachine::Connection#get_status (method)">#get_status</a></span>, <span class='object_link'><a href="../Connection.html#notify_readable%3D-instance_method" title="EventMachine::Connection#notify_readable= (method)">#notify_readable=</a></span>, <span class='object_link'><a href="../Connection.html#notify_readable%3F-instance_method" title="EventMachine::Connection#notify_readable? (method)">#notify_readable?</a></span>, <span class='object_link'><a href="../Connection.html#notify_writable%3D-instance_method" title="EventMachine::Connection#notify_writable= (method)">#notify_writable=</a></span>, <span class='object_link'><a href="../Connection.html#notify_writable%3F-instance_method" title="EventMachine::Connection#notify_writable? (method)">#notify_writable?</a></span>, <span class='object_link'><a href="../Connection.html#pause-instance_method" title="EventMachine::Connection#pause (method)">#pause</a></span>, <span class='object_link'><a href="../Connection.html#paused%3F-instance_method" title="EventMachine::Connection#paused? (method)">#paused?</a></span>, <span class='object_link'><a href="../Connection.html#pending_connect_timeout-instance_method" title="EventMachine::Connection#pending_connect_timeout (method)">#pending_connect_timeout</a></span>, <span class='object_link'><a href="../Connection.html#pending_connect_timeout%3D-instance_method" title="EventMachine::Connection#pending_connect_timeout= (method)">#pending_connect_timeout=</a></span>, <span class='object_link'><a href="../Connection.html#proxy_completed-instance_method" title="EventMachine::Connection#proxy_completed (method)">#proxy_completed</a></span>, <span class='object_link'><a href="../Connection.html#proxy_incoming_to-instance_method" title="EventMachine::Connection#proxy_incoming_to (method)">#proxy_incoming_to</a></span>, <span class='object_link'><a href="../Connection.html#proxy_target_unbound-instance_method" title="EventMachine::Connection#proxy_target_unbound (method)">#proxy_target_unbound</a></span>, <span class='object_link'><a href="../Connection.html#receive_data-instance_method" title="EventMachine::Connection#receive_data (method)">#receive_data</a></span>, <span class='object_link'><a href="../Connection.html#reconnect-instance_method" title="EventMachine::Connection#reconnect (method)">#reconnect</a></span>, <span class='object_link'><a href="../Connection.html#resume-instance_method" title="EventMachine::Connection#resume (method)">#resume</a></span>, <span class='object_link'><a href="../Connection.html#send_data-instance_method" title="EventMachine::Connection#send_data (method)">#send_data</a></span>, <span class='object_link'><a href="../Connection.html#send_datagram-instance_method" title="EventMachine::Connection#send_datagram (method)">#send_datagram</a></span>, <span class='object_link'><a href="../Connection.html#send_file_data-instance_method" title="EventMachine::Connection#send_file_data (method)">#send_file_data</a></span>, <span class='object_link'><a href="../Connection.html#set_sock_opt-instance_method" title="EventMachine::Connection#set_sock_opt (method)">#set_sock_opt</a></span>, <span class='object_link'><a href="../Connection.html#ssl_handshake_completed-instance_method" title="EventMachine::Connection#ssl_handshake_completed (method)">#ssl_handshake_completed</a></span>, <span class='object_link'><a href="../Connection.html#ssl_verify_peer-instance_method" title="EventMachine::Connection#ssl_verify_peer (method)">#ssl_verify_peer</a></span>, <span class='object_link'><a href="../Connection.html#start_tls-instance_method" title="EventMachine::Connection#start_tls (method)">#start_tls</a></span>, <span class='object_link'><a href="../Connection.html#stop_proxying-instance_method" title="EventMachine::Connection#stop_proxying (method)">#stop_proxying</a></span>, <span class='object_link'><a href="../Connection.html#stream_file_data-instance_method" title="EventMachine::Connection#stream_file_data (method)">#stream_file_data</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="EventMachine::Protocols::SmtpClient (class)">SmtpClient</a></span></tt>) <strong>initialize</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>A new instance of SmtpClient</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/protocols/smtpclient.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@succeeded</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@responder</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@code</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@msg</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="args=-instance_method">
  
    - (<tt>Object</tt>) <strong>args=</strong>(value)  <span class="extras">(writeonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sets the attribute args</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>the value to set the attribute args to.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/protocols/smtpclient.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_args='>args=</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='ivar'>@args</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="send-class_method">
  
    + (<tt>Object</tt>) <strong>send</strong>(args = {}) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>:host =&gt; required String
  a string containing the IP address or host name of the SMTP server to connect to.
:port =&gt; optional
  defaults to 25.
:domain =&gt; required String
  This is passed as the argument to the EHLO command.
:starttls =&gt; optional Boolean
  If it evaluates true, then the client will initiate STARTTLS with
  the server, and abort the connection if the negotiation doesn’t succeed.
  TODO, need to be able to pass certificate parameters with this option.
:auth =&gt; optional Hash of auth parameters
  If not given, then no auth will be attempted.
  (In that case, the connection will be aborted if the server requires auth.)
  Specify the hash value :type to determine the auth type, along with additional parameters
  depending on the type.
  Currently only :type =&gt; :plain is supported. Pass additional parameters :username (String),
  and :password (either a String or a Proc that will be called at auth-time).</p>

<p>@example
    :auth =&gt; :username=&gt;”mickey@disney.com”, :password=&gt;”mouse”</p>

<p>:from =&gt; required String
  Specifies the sender of the message. Will be passed as the argument
  to the MAIL FROM. Do NOT enclose the argument in angle-bracket (&lt;&gt;) characters.
  The connection will abort if the server rejects the value.
:to =&gt; required String or Array of Strings
  The recipient(s) of the message. Do NOT enclose
  any of the values in angle-brackets (&lt;&gt;) characters. It’s NOT a fatal error if one or more
  recipients are rejected by the server. (Of course, if ALL of them are, the server will most
  likely trigger an error when we try to send data.) An array of codes containing the status
  of each requested recipient is available after the call completes. TODO, we should define
  an overridable stub that will be called on rejection of a recipient or a sender, giving
  user code the chance to try again or abort the connection.
:header =&gt; Required hash of values to be transmitted in the header of the message.
  The hash keys are the names of the headers (do NOT append a trailing colon), and the values are strings
  containing the header values. TODO, support Arrays of header values, which would cause us to
  send that specific header line more than once.</p>

<p>@example
    :header =&gt; =&gt; “Bogus”, “CC” =&gt; “myboss@example.com”</p>

<p>:body =&gt; Optional string, defaults blank.
  This will be passed as the body of the email message.
  TODO, this needs to be significantly beefed up. As currently written, this requires the caller
  to properly format the input into CRLF-delimited lines of 7-bit characters in the standard
  SMTP transmission format. We need to be able to automatically convert binary data, and add
  correct line-breaks to text data. I think the :body parameter should remain as it is, and we
  should add a :content parameter that contains autoconversions and/or conversion parameters.
  Then we can check if either :body or :content is present and do the right thing.
:content =&gt; Optional array or string
  Alternative to providing header and body, an array or string of raw data which MUST be in
  correct SMTP body format, including a trailing dot line
:verbose =&gt; Optional.
  If true, will cause a lot of information (including the server-side of the
  conversation) to be dumped to $&gt;.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/protocols/smtpclient.rb', line 134</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span> <span class='id identifier rubyid_args'>args</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:port</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>25</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:body</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>

<span class='embdoc_beg'>=begin
</span><span class='embdoc'>(I don&#39;t think it&#39;s possible for EM#connect to throw an exception under normal
</span><span class='embdoc'>circumstances, so this original code is stubbed out. A connect-failure will result
</span><span class='embdoc'>in the #unbind method being called without calling #connection_completed.)
</span><span class='embdoc'>begin
</span><span class='embdoc'>  EventMachine.connect( args[:host], args[:port], self) {|c|
</span><span class='embdoc'>    # According to the EM docs, we will get here AFTER post_init is called.
</span><span class='embdoc'>    c.args = args
</span><span class='embdoc'>    c.set_comm_inactivity_timeout 60
</span><span class='embdoc'>  }
</span><span class='embdoc'>rescue
</span><span class='embdoc'>  # We&#39;ll get here on a connect error. This code mimics the effect
</span><span class='embdoc'>  # of a call to invoke_internal_error. Would be great to DRY this up.
</span><span class='embdoc'>  # (Actually, it may be that we never get here, if EM#connect catches
</span><span class='embdoc'>  # its errors internally.)
</span><span class='embdoc'>  d = EM::DefaultDeferrable.new
</span><span class='embdoc'>  d.set_deferred_status(:failed, {:error=&gt;[:connect, 500, &quot;unable to connect to server&quot;]})
</span><span class='embdoc'>  d
</span><span class='embdoc'>end
</span><span class='embdoc_end'>=end
</span>  <span class='const'>EventMachine</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:host</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:port</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span>
    <span class='comment'># According to the EM docs, we will get here AFTER post_init is called.
</span>    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
    <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_set_comm_inactivity_timeout'>set_comm_inactivity_timeout</span> <span class='int'>60</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Feb 21 19:35:00 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>