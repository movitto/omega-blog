<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: EventMachine::Deferrable
  
    &mdash; Documentation by YARD 0.8.5.2
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../EventMachine.html" title="EventMachine (module)">EventMachine</a></span></span>
     &raquo; 
    <span class="title">Deferrable</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: EventMachine::Deferrable
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Completion.html" title="EventMachine::Completion (class)">Completion</a></span>, <span class='object_link'><a href="DNS/Request.html" title="EventMachine::DNS::Request (class)">EventMachine::DNS::Request</a></span>, <span class='object_link'><a href="DefaultDeferrable.html" title="EventMachine::DefaultDeferrable (class)">DefaultDeferrable</a></span>, <span class='object_link'><a href="DeferrableChildProcess.html" title="EventMachine::DeferrableChildProcess (class)">DeferrableChildProcess</a></span>, <span class='object_link'><a href="FileStreamer.html" title="EventMachine::FileStreamer (class)">FileStreamer</a></span>, <span class='object_link'><a href="Protocols/HttpClient.html" title="EventMachine::Protocols::HttpClient (class)">Protocols::HttpClient</a></span>, <span class='object_link'><a href="Protocols/Memcache.html" title="EventMachine::Protocols::Memcache (module)">Protocols::Memcache</a></span>, <span class='object_link'><a href="Protocols/SmtpClient.html" title="EventMachine::Protocols::SmtpClient (class)">Protocols::SmtpClient</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/em/future.rb<span class="defines">,<br />
  lib/em/deferrable.rb</span>
</dd>
  
</dl>
<div class="clear"></div>








  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#future-class_method" title="future (class method)">+ (Object) <strong>future</strong>(arg, cb = nil, eb = nil, &amp;blk) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A future is a sugaring of a typical deferrable usage.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#callback-instance_method" title="#callback (instance method)">- (Object) <strong>callback</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Specify a block to be executed if and when the Deferrable object receives
a status of :succeeded.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cancel_callback-instance_method" title="#cancel_callback (instance method)">- (Object) <strong>cancel_callback</strong>(block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Cancels an outstanding callback to &amp;block if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cancel_errback-instance_method" title="#cancel_errback (instance method)">- (Object) <strong>cancel_errback</strong>(block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Cancels an outstanding errback to &amp;block if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cancel_timeout-instance_method" title="#cancel_timeout (instance method)">- (Object) <strong>cancel_timeout</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Cancels an outstanding timeout if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#errback-instance_method" title="#errback (instance method)">- (Object) <strong>errback</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Specify a block to be executed if and when the Deferrable object receives
a status of :failed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fail-instance_method" title="#fail (instance method)">- (Object) <strong>fail</strong>(*args) </a>
    

    
      (also: #set_deferred_failure)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sugar for set_deferred_status(:failed, …).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_deferred_status-instance_method" title="#set_deferred_status (instance method)">- (Object) <strong>set_deferred_status</strong>(status, *args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sets the “disposition” (status) of the Deferrable object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#succeed-instance_method" title="#succeed (instance method)">- (Object) <strong>succeed</strong>(*args) </a>
    

    
      (also: #set_deferred_success)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sugar for set_deferred_status(:succeeded, …).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout-instance_method" title="#timeout (instance method)">- (Object) <strong>timeout</strong>(seconds, *args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Setting a timeout on a Deferrable causes it to go into the failed state after
the Timeout expires (passing no arguments to the object’s errbacks).</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="future-class_method">
  
    + (<tt>Object</tt>) <strong>future</strong>(arg, cb = nil, eb = nil, &amp;blk) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <h2 id="a-future-is-a-sugaring-of-a-typical-deferrable-usage">A future is a sugaring of a typical deferrable usage.</h2>
<p>Evaluate arg (which may be an expression or a block).
What’s the class of arg?
If arg is an ordinary expression, then return it.
If arg is deferrable (responds to :set_deferred_status),
then look at the arguments. If either callback or errback
are defined, then use them. If neither are defined, then
use the supplied block (if any) as the callback.
Then return arg.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/future.rb', line 44</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_future'>future</span> <span class='id identifier rubyid_arg'>arg</span><span class='comma'>,</span> <span class='id identifier rubyid_cb'>cb</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_eb'>eb</span><span class='op'>=</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span>
  <span class='id identifier rubyid_arg'>arg</span> <span class='op'>=</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span> <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:call</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:set_deferred_status</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cb'>cb</span> <span class='op'>||</span> <span class='id identifier rubyid_eb'>eb</span>
      <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_callback'>callback</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_cb'>cb</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_cb'>cb</span>
      <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_errback'>errback</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_eb'>eb</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_eb'>eb</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_arg'>arg</span><span class='period'>.</span><span class='id identifier rubyid_callback'>callback</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_blk'>blk</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_blk'>blk</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_arg'>arg</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="callback-instance_method">
  
    - (<tt>Object</tt>) <strong>callback</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Specify a block to be executed if and when the Deferrable object receives
a status of :succeeded. See #set_deferred_status for more information.</p>

<p>Calling this method on a Deferrable object whose status is not yet known
will cause the callback block to be stored on an internal list.
If you call this method on a Deferrable whose status is :succeeded, the
block will be executed immediately, receiving the parameters given to the
prior #set_deferred_status call.</p>

<p>–
If there is no status, add a callback to an internal list.
If status is succeeded, execute the callback immediately.
If status is failed, do nothing.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46
47
48
49
50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_callback'>callback</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@deferred_status</span> <span class='op'>||=</span> <span class='symbol'>:unknown</span>
  <span class='kw'>if</span> <span class='ivar'>@deferred_status</span> <span class='op'>==</span> <span class='symbol'>:succeeded</span>
    <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='ivar'>@deferred_args</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='ivar'>@deferred_status</span> <span class='op'>!=</span> <span class='symbol'>:failed</span>
    <span class='ivar'>@callbacks</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@callbacks</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span> <span class='id identifier rubyid_block'>block</span> <span class='comment'># &lt;&lt; block
</span>  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cancel_callback-instance_method">
  
    - (<tt>Object</tt>) <strong>cancel_callback</strong>(block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Cancels an outstanding callback to &amp;block if any. Undoes the action of #callback.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 58</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cancel_callback'>cancel_callback</span> <span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@callbacks</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@callbacks</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cancel_errback-instance_method">
  
    - (<tt>Object</tt>) <strong>cancel_errback</strong>(block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Cancels an outstanding errback to &amp;block if any. Undoes the action of #errback.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 84</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cancel_errback'>cancel_errback</span> <span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@errbacks</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@errbacks</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cancel_timeout-instance_method">
  
    - (<tt>Object</tt>) <strong>cancel_timeout</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Cancels an outstanding timeout if any. Undoes the action of #timeout.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


179
180
181
182
183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 179</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cancel_timeout'>cancel_timeout</span>
  <span class='ivar'>@deferred_timeout</span> <span class='op'>||=</span> <span class='kw'>nil</span>
  <span class='kw'>if</span> <span class='ivar'>@deferred_timeout</span>
    <span class='ivar'>@deferred_timeout</span><span class='period'>.</span><span class='id identifier rubyid_cancel'>cancel</span>
    <span class='ivar'>@deferred_timeout</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="errback-instance_method">
  
    - (<tt>Object</tt>) <strong>errback</strong>(&amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Specify a block to be executed if and when the Deferrable object receives
a status of :failed. See #set_deferred_status for more information.
–
If there is no status, add an errback to an internal list.
If status is failed, execute the errback immediately.
If status is succeeded, do nothing.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_errback'>errback</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block'>block</span>
  <span class='ivar'>@deferred_status</span> <span class='op'>||=</span> <span class='symbol'>:unknown</span>
  <span class='kw'>if</span> <span class='ivar'>@deferred_status</span> <span class='op'>==</span> <span class='symbol'>:failed</span>
    <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='ivar'>@deferred_args</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='ivar'>@deferred_status</span> <span class='op'>!=</span> <span class='symbol'>:succeeded</span>
    <span class='ivar'>@errbacks</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@errbacks</span><span class='period'>.</span><span class='id identifier rubyid_unshift'>unshift</span> <span class='id identifier rubyid_block'>block</span> <span class='comment'># &lt;&lt; block
</span>  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fail-instance_method">
  
    - (<tt>Object</tt>) <strong>fail</strong>(*args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='set_deferred_failure-instance_method'>set_deferred_failure</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sugar for set_deferred_status(:failed, …)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fail'>fail</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='id identifier rubyid_set_deferred_status'>set_deferred_status</span> <span class='symbol'>:failed</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_deferred_status-instance_method">
  
    - (<tt>Object</tt>) <strong>set_deferred_status</strong>(status, *args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sets the “disposition” (status) of the Deferrable object. See also the large set of
sugarings for this method.
Note that if you call this method without arguments,
no arguments will be passed to the callback/errback.
If the user has coded these with arguments, then the
user code will throw an argument exception.
Implementors of deferrable classes <b>must</b>
document the arguments they will supply to user callbacks.</p>

<p>OBSERVE SOMETHING VERY SPECIAL here: you may call this method even
on the INSIDE of a callback. This is very useful when a previously-registered
callback wants to change the parameters that will be passed to subsequently-registered
ones.</p>

<p>You may give either :succeeded or :failed as the status argument.</p>

<p>If you pass :succeeded, then all of the blocks passed to the object using the #callback
method (if any) will be executed BEFORE the #set_deferred_status method returns. All of the blocks
passed to the object using #errback will be discarded.</p>

<p>If you pass :failed, then all of the blocks passed to the object using the #errback
method (if any) will be executed BEFORE the #set_deferred_status method returns. All of the blocks
passed to the object using # callback will be discarded.</p>

<p>If you pass any arguments to #set_deferred_status in addition to the status argument,
they will be passed as arguments to any callbacks or errbacks that are executed.
It’s your responsibility to ensure that the argument lists specified in your callbacks and
errbacks match the arguments given in calls to #set_deferred_status, otherwise Ruby will raise
an ArgumentError.</p>

<p>–
We’re shifting callbacks off and discarding them as we execute them.
This is valid because by definition callbacks are executed no more than
once. It also has the magic effect of permitting recursive calls, which
means that a callback can call #set_deferred_status and change the parameters
that will be sent to subsequent callbacks down the chain.</p>

<p>Changed @callbacks and @errbacks from push/shift to unshift/pop, per suggestion
by Kirk Haines, to work around the memory leak bug that still exists in many Ruby
versions.</p>

<p>Changed 15Sep07: after processing callbacks or errbacks, CLEAR the other set of
handlers. This gets us a little closer to the behavior of Twisted’s “deferred,”
which only allows status to be set once. Prior to making this change, it was possible
to “succeed” a Deferrable (triggering its callbacks), and then immediately “fail” it,
triggering its errbacks! That is clearly undesirable, but it’s just as undesirable
to raise an exception is status is set more than once on a Deferrable. The latter
behavior would invalidate the idiom of resetting arguments by setting status from
within a callback or errback, but more seriously it would cause spurious errors
if a Deferrable was timed out and then an attempt was made to succeed it. See the
comments under the new method #timeout.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 141</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_deferred_status'>set_deferred_status</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='id identifier rubyid_cancel_timeout'>cancel_timeout</span>
  <span class='ivar'>@errbacks</span> <span class='op'>||=</span> <span class='kw'>nil</span>
  <span class='ivar'>@callbacks</span> <span class='op'>||=</span> <span class='kw'>nil</span>
  <span class='ivar'>@deferred_status</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span>
  <span class='ivar'>@deferred_args</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span>
  <span class='kw'>case</span> <span class='ivar'>@deferred_status</span>
  <span class='kw'>when</span> <span class='symbol'>:succeeded</span>
    <span class='kw'>if</span> <span class='ivar'>@callbacks</span>
      <span class='kw'>while</span> <span class='id identifier rubyid_cb'>cb</span> <span class='op'>=</span> <span class='ivar'>@callbacks</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span>
        <span class='id identifier rubyid_cb'>cb</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='ivar'>@deferred_args</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='ivar'>@errbacks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span> <span class='kw'>if</span> <span class='ivar'>@errbacks</span>
  <span class='kw'>when</span> <span class='symbol'>:failed</span>
    <span class='kw'>if</span> <span class='ivar'>@errbacks</span>
      <span class='kw'>while</span> <span class='id identifier rubyid_eb'>eb</span> <span class='op'>=</span> <span class='ivar'>@errbacks</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span>
        <span class='id identifier rubyid_eb'>eb</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='op'>*</span><span class='ivar'>@deferred_args</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='ivar'>@callbacks</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span> <span class='kw'>if</span> <span class='ivar'>@callbacks</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="succeed-instance_method">
  
    - (<tt>Object</tt>) <strong>succeed</strong>(*args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='set_deferred_success-instance_method'>set_deferred_success</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sugar for set_deferred_status(:succeeded, …)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_succeed'>succeed</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='id identifier rubyid_set_deferred_status'>set_deferred_status</span> <span class='symbol'>:succeeded</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="timeout-instance_method">
  
    - (<tt>Object</tt>) <strong>timeout</strong>(seconds, *args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Setting a timeout on a Deferrable causes it to go into the failed state after
the Timeout expires (passing no arguments to the object’s errbacks).
Setting the status at any time prior to a call to the expiration of the timeout
will cause the timer to be cancelled.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172
173
174
175</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/em/deferrable.rb', line 170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_timeout'>timeout</span> <span class='id identifier rubyid_seconds'>seconds</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>
  <span class='id identifier rubyid_cancel_timeout'>cancel_timeout</span>
  <span class='id identifier rubyid_me'>me</span> <span class='op'>=</span> <span class='kw'>self</span>
  <span class='ivar'>@deferred_timeout</span> <span class='op'>=</span> <span class='const'>EventMachine</span><span class='op'>::</span><span class='const'>Timer</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_seconds'>seconds</span><span class='rparen'>)</span> <span class='lbrace'>{</span><span class='id identifier rubyid_me'>me</span><span class='period'>.</span><span class='id identifier rubyid_fail'>fail</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span><span class='rbrace'>}</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Feb 21 19:34:59 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.5.2 (ruby-2.0.0).
</div>

  </body>
</html>